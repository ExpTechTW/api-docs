---
title: "不能忽略的 CVE-2025-66478 滿級漏洞 :("
description: "CVE-2025-66478 是一個影響 Next.js 的嚴重安全漏洞，源自 React Server Components (RSC) 協議中的缺陷，可能導致伺服器被遠端執行腳本或指令。還好平常有使用 Docker 部署，大幅降低了損害。"
date: 2025-12-17
slug: sharing-2025-12-17
image: /img/ExpTech_Studio_white.png
authors: [PiscesXD]
tags: [PiscesXD, sharing, CVE, Next.js, Docker]
keywords: [開發分享, Next.js, 安全漏洞, CVE, Docker]
---

import SeverityBadge from "@site/src/components/SeverityBadge";
import StatusBadge from "@site/src/components/StatusBadge";

<SeverityBadge level="high" />
<StatusBadge status="resolved" />

---

CVE-2025-66478 是一個影響 Next.js 的嚴重安全漏洞，源自 React Server Components (RSC) 協議中的缺陷，可能導致伺服器被遠端執行腳本或指令。還好平常有使用 Docker 部署，大幅降低了損害。

{/* truncate */}

## 事件概述

- **發現時間：** 2025/12/8
- **CVSS 評分：** 10.0 (Critical)
- **漏洞類型：** 遠端程式碼執行 (Remote Code Execution)
- **攻擊向量：** 網路攻擊，無需身份驗證

## 敘說

一開始知道這個漏洞時，我以為這個漏洞只是一個小問題，後來才發現自己的 IP 被 Cloudflare 列入黑名單後，才意識到事情的嚴重性。
平常使用的 Docker 卻拯救了伺服器，因為前端後端分離設計，讓攻擊者無法讀取後端一些敏感數據，且也沒有掛載實體檔案所以入侵到宿主機的機率偏低
，只需要重新 Build 部署和更新 Next.js版本，就可以解決大部分問題，因為重新 Build 會變成一個乾淨的環境。

## 漏洞詳情

### 技術細節

CVE-2025-66478 源於 React 的上游實作（CVE-2025-55182），在特定條件下，攻擊者可以透過漏洞的構造請求，觸發伺服器端的未預期執行路徑，從而實現遠端執行腳本或指令。

#### 漏洞成因

1. **React Server Components (RSC) 協議缺陷**
   - RSC 協議在處理特定請求時存在安全漏洞
   - 攻擊者可構造惡意請求繞過安全檢查

2. **執行路徑控制**
   - 漏洞允許攻擊者控制伺服器端的程式碼執行流程
   - 可繞過現有的安全防護機制

#### 攻擊方式

當時發現攻擊者連線進來之後．會先嘗試讀取一些伺服器已安裝的套件，在嘗試下載腳本並執行．

目前所遇到腳本類型有:
- **偽裝的Nginx**
- **挖礦腳本**
- **後門腳本** (含開機腳本相當可怕)
- **架設VPN**
- **powershell腳本**

下方圖片是其中一個腳本：
![](/img/sharing/2025-12-17/image.png)

## 參考資源

- [Next.js 官方安全公告](https://nextjs.org/blog/CVE-2025-66478)
- [React CVE-2025-55182](https://github.com/facebook/react/security/advisories)

## 總結

CVE-2025-66478 是一個極為嚴重的安全漏洞（CVSS 10.0），可能導致伺服器完全被攻擊者控制。這次事ㄌ件過後我會更加注重伺服器的安全性，避免類似的問題再次發生，且多關注有關 CVE 的資訊。